<!DOCTYPE html>
<html>

<head>
  <title>Wheels of Fortune</title>
  <script src="jsPsych/jspsych.js"></script>
  <script src="jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
  <script src="jsPsych/plugins/jspsych-html-button-response.js"></script>
  <script src="jsPsych/plugins/jspsych-image-keyboard-response.js"></script>
  <script src="jsPsych/plugins/jspsych-wof-choose-spin.js"></script>
  <script src="jsPsych/plugins/jspsych-wof-slider-response.js"></script>
  <script src="jsPsych/snap.svg.js"></script>
  <script src="PapaParse/papaparse.js"></script>
  <script src="trial_list.js"></script>
  <script src="prac_list.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="jsPsych/css/jspsych.css">
  <link rel="stylesheet" href="jsPsych/css/extra.css">
</head>

<body></body>
<script>
  /* create timeline */
  var timeline = [];

  // arrow code
  var arrow = ['<svg id="arrow0" height = "300px" width = "300px" style="position: absolute; top:0; left:0;"></svg>',
              '<svg id="arrow1" height = "300px" width = "300px" style="position: absolute; top:0; left:0;"></svg>']

  // variable to hold button pressed on each trial
  var button_pressed

  /* define welcome message trial */
  var welcome_block = {
    type: "html-keyboard-response",
    stimulus: "Welcome to the experiment. Press any key to begin."
  };
  //timeline.push(welcome_block);

  /* define ready message trial */
  var ready_block = {
    type: "html-keyboard-response",
    stimulus: "Great! Now you're ready for the real thing. Press any key to begin."
  };
  //timeline.push(ready_block);

  /* define instructions trial */
  var instructions = {
    type: "html-keyboard-response",
    stimulus: "<p>In this game, you are trying to win as many points as possible. You get to choose between two wheels of fortune. After you choose a wheel, you'll see an arrow spinning.When the spinning arrow stops, points will be added or subtracted from your running total. You will then be asked to record how you feel about the outcome. Press any key to continue.</p>",
    post_trial_gap: 500
  };
  //timeline.push(instructions);

  // Example trial variables

  var trial = {
    type: 'wof-choose-spin',
    trial_type: jsPsych.timelineVariable('trial_type'),
    left_value_1: jsPsych.timelineVariable('left_value_1'),
    left_value_2: jsPsych.timelineVariable('left_value_2'),
    left_prob_1: jsPsych.timelineVariable('left_prob_1'),
    left_outcome: jsPsych.timelineVariable('left_outcome'),
    trial_type: jsPsych.timelineVariable('trial_type'),
    right_value_1: jsPsych.timelineVariable('right_value_1'),
    right_value_2: jsPsych.timelineVariable('right_value_2'),
    right_prob_1: jsPsych.timelineVariable('right_prob_1'),
    right_outcome: jsPsych.timelineVariable('right_outcome'),
    post_trial_gap: 1000
  }

  var slider_happy = {
    type: 'wof-slider-response',
    labels: ['not at all happy', 'very happy'],
    clear_screen: false,
    post_trial_gap: 1000
  }


  var slider_sad = {
    type: 'wof-slider-response',
    labels: ['not at all sad', 'very sad'],
    clear_screen: true,
    post_trial_gap: 1000
  }

  var slider_relieved = {
    type: 'wof-slider-response',
    labels: ['not at all relieved', 'very relieved'],
    clear_screen: false,
    post_trial_gap: 1000
  }

  var slider_regretful = {
    type: 'wof-slider-response',
    labels: ['not at all regretful', 'very regretful'],
    clear_screen: false,
    post_trial_gap: 1000
  }

  var slider_satisfied = {
    type: 'wof-slider-response',
    labels: ['not at all satisfied', 'very satisfied'],
    clear_screen: false,
    post_trial_gap: 1000
  }

  var slider_disappointed = {
    type: 'wof-slider-response',
    labels: ['not at all disappointed', 'very disappointed'],
    clear_screen: false,
    post_trial_gap: 1000
  }

  var prac_procedure = {
    timeline: [welcome_block, instructions, trial, slider_happy, slider_sad, slider_relieved, slider_regretful, slider_satisfied, slider_disappointed],
    timeline_variables: prac_list,
    randomize_order: true,
    sample: {
        type: 'without-replacement',
        size: 5, // sample 5 trials, without replacement
    }
  }
  timeline.push(prac_procedure);

  var test_procedure = {
    timeline: [ready_block, trial, slider_happy, slider_sad, slider_relieved, slider_regretful, slider_satisfied, slider_disappointed],
    timeline_variables: trial_list,
    randomize_order: true,
    sample: {
        type: 'without-replacement',
        size: 5, // sample 5 trials, without replacement
    }
  }
  timeline.push(test_procedure);


  /* start the experiment */
  jsPsych.init({
    timeline: timeline,
    on_finish: function() {
      //jsPsych.data.displayData();
      jsPsych.data.get().localSave('csv','wheels_data.csv');
    }
  });
</script>

</html>
